<!DOCTYPE html>
<html>
<head>
    <title>æ”¶æ”¯è´¢åŠ¡æŠ¥è¡¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; max-width: 600px; margin: auto; text-align: center; background: #f4f7f6; }
        .container { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-top: 50px; }
        canvas { max-width: 100%; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š æ”¯å‡ºåˆ†ç±»å æ¯”</h1>
        <canvas id="pieChart"></canvas>
        <div id="status">æ­£åœ¨åŠ è½½æ•°æ®...</div>
    </div>

    <script>
        async function drawChart() {
            try {
                // âš ï¸ æ›¿æ¢ä¸ºä½ è‡ªå·±çš„ Worker é“¾æ¥
                const response = await fetch('https://ä½ çš„Workerå.ä½ çš„å­åŸŸ.workers.dev/api/data');
                const data = await response.json();

                // è¿‡æ»¤æ”¯å‡ºæ•°æ®
                const expenses = data.filter(item => item.type === 'expense');
                
                if (expenses.length === 0) {
                    document.getElementById('status').innerText = "æš‚æ— æ”¯å‡ºæ•°æ®";
                    return;
                }

                const labels = expenses.map(item => item.category);
                const values = expenses.map(item => item.value);

                const ctx = document.getElementById('pieChart').getContext('2d');
                new Chart(ctx, {
                    type: 'pie', // é¥¼çŠ¶å›¾
                    data: {
                        labels: labels,
                        datasets: [{
                            data: values,
                            backgroundColor: [
                                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'
                            ]
                        }]
                    },
                    options: {
                        plugins: {
                            legend: { position: 'bottom' }
                        }
                    }
                });
                document.getElementById('status').innerText = "";
            } catch (err) {
                document.getElementById('status').innerText = "åŠ è½½å¤±è´¥: " + err.message;
            }
        }
        drawChart();
    </script>
</body>
</html>
